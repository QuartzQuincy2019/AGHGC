<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGHGC</title>
    <script src="./js/plugins/ZERBO.js"></script>
    <script src="./js/plugins/mjd.js"></script>
    <script src="./js/settings.js"></script>
    <script src="./js/core.js"></script>
    <script src="./js/lang.js"></script>
    <script src="./js/version.js"></script>
    <script src="./js/pool.js"></script>
    <script src="./js/database.js"></script>
    <link rel="stylesheet" href=".\css\module.css">
    <link rel="stylesheet" href=".\css\l.css">
    <link rel="stylesheet" href=".\css\i.css">
    <link rel="stylesheet" href=".\css\records.css">
</head>

<body>
    <h1>Augmented Graphic HSR Gacha Calculator - AGHGC</h1>
    <h3>《崩坏：星穹铁道》抽卡计算器</h3>
    <h3>v1.1.0-b-a4</h3>
    <p>目前支持部分角色和光锥卡池。其他卡池将于后续版本更新。受fandom更新频率影响，部分图片可能处于缺失状态。</p>
    <div class="SubmitButton ArtisticButton1" onclick="switchLanguage();">切换数据库语言</div>
    <div class="module">
        <h2>当前卡池信息 - Current Pool Status</h2>
        <p>当前版本阶段（@1表示上半，@2表示下半）：<span id="VersionDisplayer" class="BoldBlue"></span></p>
        <p>当前Up角色：<span id="CurrentSupCharacters"></span></p>
        <p>当前Up光锥：<span id="CurrentSupLightcones"></span></p>
    </div>
    <div id="AdvFilterArea" class="module">
        <h2>卡池筛选和选择 - Pool Filter & Pool Selection</h2>
        <p id="DisplayerPoolQuantity"></p>
        <p>为方便卡池搜索，此功能通过用户提供卡池关键词来实现卡池搜索。</p>
        <p>网页全局通用该功能，并列关键词间以1个空格分隔，筛选出的卡池同时满足所给予的所有关键词。</p>
        <p><span
                class="BoldYellow">支持</span>：完整或不完整的中（简体）、英、日文名、别名、绰号，以及某些错拼。其他信息，如日期202X、202X-XX、202X-XX-XX，以及主版本号X.X，命途名称、属性名称
        </p>
        <div class="group">
            <p class="BoldBlue">关键词输入：
                <textarea id="Form_AdvPoolFilter" class="AdvancedPoolFilter" title="Advanced Pool Filter"
                    placeholder='如："2025 2.7 忘归"  "大停云"  "记忆 3.2"  "phainon"  "量子 3.1"  "向着不可"  "2025-04-26" '></textarea>
                全局卡池选择：<br><select id="Form_CharacterPoolInput" title="Select Pool"></select>
            </p>
        </div>
    </div>
    <div class="module">
        <h2>概率分布模块 - Probability Distribution Calculation</h2>
        <p>展示投入不同票数后，能获得(至少)目标个数五星Up的的概率。</p>
        <p class="CenteredText BoldYellow">说 明</p>
        <p>概率以表格形式呈现。如某角色卡池抽取目标数量为3，小保底，0垫数，则表格中计算值“203/19.36850%”表示“以小保底0五星垫数为起点，若向卡池投入203抽，则将有19.36850%的概率获得(至少)3个五星Up”
        </p>
        <p>“达成抽取目标的期望抽数”表示达成抽取目标所需要的平均抽数。如小保底、0垫数，抽取3个五星Up的期望抽数是“268.65724”，则表示“以小保底0垫数为起点，平均需要268.65724抽就能抽出(至少)3个五星Up”
        </p>
        <p>概率误差：±0.00001%</p>
        <div class="group">
            <form id="PredictionForm">
                <p>是否5星大保底（是：1；否：0）</p><input id="PreForm_GuaranteeInput" title="Is Guaranteed" type="number" min="0"
                    max="1" value="0"><br>
                <p>已多少抽未出五星（若上一抽是5星，则为0，以此类推）</p><input id="PreForm_SCountInput" title="SCount Input" type="number"
                    min="0" max="89" value="0"><br>
                <!-- <p>囤积票数(最大值:1200)：</p><input id="PreForm_PullInput" class="KeyNumberInput" title="Simulate Times" type="number" -->
                <!-- min="1" max="1200" value="0"><br> -->
                <p>抽取目标数量：</p>
                <p id="PreForm_SupTargetDisplay">该卡池5星Up角色/光锥 x</p><input id="PreForm_SupInput" class="KeyNumberInput"
                    title="Target: Sup" type="number" min="0" max="7" value="0"><br>
                <div class="SubmitButton ArtisticButton1" onclick="predict();">开始计算</div>
            </form>
        </div>
        <div id="PredictionExpectationArea"></div>
        <div id="PredictionTableArea"></div>
    </div>

    <div class="module">
        <h2>抽卡模拟模块 - Simple Pull Simulation</h2>
        <p>抽取总次数：最大值<span id="E_MAX_ALLOWED_PULLS" class="BoldRed">?</span>。</p>
        <p>筛选器：仅查看选取的角色的抽取记录。</p>
        <p>垫数：在这一抽之前，有多少抽未出5星。即自上一次抽出5星到这一抽，未出5星总共的专票数。</p>
        <p class="BoldRed">考虑到设备性能，抽数大于<span id="E_MAX_GENERAL_RECORD_QUANTITY">?</span>抽，不显示“获取总览”；大于<span
                id="E_MAX_FILTERED_RECORD_QUANTITY"></span>抽，不显示“筛选结果”，但<span
                class="BoldBlue">始终可以</span>从“筛选器”中可以看到抽取到的角色数量。
            <hr>
        <div id="ScommonSelector" class="group ScommonSelectors">
            <p class="CenteredText"><span class="BoldGreen">♥ 星 缘 相 邀</span></p>
            <p>注：在v3.2@1（2025年04月09日）及以后的版本，玩家能自选五星常驻角色。此模块能实现玩家常驻卡池的自选。
                <br>
                <span class="BoldRed">横线上方</span>是玩家选择<span class="BoldRed">能获取</span>的5星常驻项目，可选数必须为<span
                    class="BoldRed">7</span>，下方是未选择的5星常驻项目。<br>
                <span class="BoldBlue">点击项目(而不是拖曳)可以切换其上下位置。</span>
            </p>
            <hr>
            <div id="ScommonSelector_Inclusion">***已选中***</div>
            <hr>
            <div id="ScommonSelector_Exclusion">***未选中***</div>
        </div>
        <div class="group">
            <form id="MainForm">
                <div id="PoolInformer"></div>
                <p>是否5星大保底（是：1；否：0）</p><input id="Form_GuaranteeInput" title="Is Guaranteed" type="number" min="0"
                    max="1" value="0"><br>
                <p>是否4星大保底（是：1；否：0）</p><input id="Form_4StarGuaranteeInput" title="Is 4-star Guaranteed" type="number"
                    min="0" max="1" value="0"><br>
                <p>已多少抽未出5星（若上一抽是5星，则为0，以此类推）</p><input id="Form_SCountInput" title="SCount Input" type="number" min="0"
                    max="89" value="0"><br>
                <p>已多少抽未出4星（若上一抽是4星，则为0，以此类推）</p><input id="Form_RCountInput" title="RCount Input" type="number" min="0"
                    max="10" value="0"><br>
                <p>抽取总次数：</p><input id="Form_PullInput" class="KeyNumberInput" title="Simulate Times" type="number"
                    min="1" max="5000000" value="0">
                <div class="SubmitButton ArtisticButton1" onclick="applyAll();">确认抽取</div>
                <br>
                <p class="BoldBlue">筛选器：</p><select id="Form_CharacterFilterSelect" title="Filter"
                    style="min-width: 100px;"></select>
            </form>
        </div>
        <h4>筛选结果(向右滑动查看更多)：</h4>
        <div class="BoxedExhibition" id="FilterResult"></div>
        <hr>
        <h4>获取总览(向右滑动查看更多)：</h4>
        <div class="BoxedExhibition" id="ResultDisplayer"></div>
    </div>
    <div class="module">
        <h2>版本查询模块 - Version Date Inquiry</h2>
        <div class="group">
            <p><span class="BoldBlue">版本日期查询</span></p>
            <p>在文本框中输入完整日期(如"2025-02-01"，<span class="BoldRed">一定要补0</span>)可查询对应版本；输入版本则查询对应日期。
                <br>输入n个“+”则可查询<span class="BoldPurple">n个半版本之后的信息</span>，n个“-”则相反。
                <br>查询到的结果中，<span class="BoldPurple">@1表示上半，@2表示下半。</span>
            </p>
            <p id="M3_E_Today"></p>
            <input type="text" title="Enter a date (YYYY-MM-dd)" id="M3_Input"
                placeholder='形如"v3.3上半"、"3.3@1"、"v3.3#1"、"3.3 1"等格式，或"++"、"-----"皆被允许'>
            <p id="M3_E_Result"></p>
        </div>
    </div>

    <div class="module">
        <h2>复合概率模块 - Complex Frequency Simulation</h2>
        <p class="BoldRed">模块四尚未开发完成。<br>目前此模块概率误差极大(±15%)，切不可作为参考。</p>
        <p>投入固定的抽数，按照某个抽卡策略，抽取到“C+L”的概率。</p>
        <p>囿于程序限制，本模块无法计算准确概率。以下所有的结果都是经过蒙特卡洛模拟得出的。</p>
        <div class="group">
            <p class="BoldBlue">抽取目标</p>
            <p>角色个数<input id="M4_C_Qty_Input" title="Quantity" type="number" min="1" max="7" value="1"></p>
            <p>光锥个数<input id="M4_L_Qty_Input" title="Quantity" type="number" min="0" max="6" value="0"></p>
            <p class="BoldBlue">角色卡池</p>
            <p>是否5星大保底（是：1；否：0）<input id="M4_C_5G_Input" title="Is Guaranteed" type="number" min="0" max="1" value="0">
            </p>
            <p>已多少抽未出5星（若上一抽是5星，则为0，以此类推）<input id="M4_C_Count_Input" title="SCount Input" type="number" min="0"
                    max="89" value="0"></p>
            <p class="BoldBlue">光锥卡池</p>
            <p>是否5星大保底（是：1；否：0）<input id="M4_L_5G_Input" title="Is Guaranteed" type="number" min="0" max="1" value="0">
            </p>
            <p>已多少抽未出5星（若上一抽是5星，则为0，以此类推）<input id="M4_L_Count_Input" title="SCount Input" type="number" min="0"
                    max="79" value="0"></p>
            <p class="BoldBlue">抽取策略</p>
            <ol>
                <li>先角色后光锥</li>
                <li>先光锥后角色</li>
                <li style="text-decoration: line-through;">一角色一光锥</li>
                <li style="text-decoration: line-through;">一光锥一角色</li>
            </ol>
            <p>选择抽取策略：<input id="M4_Strategy_Input" title="Strategy" type="number" min="1" max="4" value="1"></p>
            <p class="BoldBlue">投入抽数</p>
            <p>投入总抽数：<input id="M4_Investment" class="KeyNumberInput" title="Invested Pulls" type="number" min="1"
                    max="1800" value="0"></p>
            <div class="SubmitButton ArtisticButton1" onclick="executeM4();">开始模拟</div>
            </form>
        </div>
        <div id="M4_Result"></div>
    </div>
    <script src="./js/warp.js"></script>
    <script src="./js/display.js"></script>
    <script src="./js/prob.js"></script>
    <script src="./js/predict.js"></script>
    <script src="./js/M3.js"></script>
    <script src="./js/M4.js"></script>
    <p>Copyright Quartz Studio 2019-2025 & By Quincy K.</p>
</body>

</html>